
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.2">
    
    
      
        <title>Model Training - ML Aide</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6f955dcd.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/material-enhancements.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="mlaide" data-md-color-primary="" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#model-training" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="ML Aide" class="md-header__button md-logo" aria-label="ML Aide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ML Aide
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Model Training
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/MLAide/docs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ML Aide" class="md-nav__button md-logo" aria-label="ML Aide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    ML Aide
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/MLAide/docs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Getting Started
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../start/quickstart/" class="md-nav__link">
        Quickstart
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        Tutorial
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tutorial" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Tutorial
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../create-connection/" class="md-nav__link">
        Create Connection
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../data-preparation/" class="md-nav__link">
        Data Preparation
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Model Training
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Model Training
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#train-test-split" class="md-nav__link">
    Train Test Split
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linear-regression" class="md-nav__link">
    Linear Regression
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lasso-regression" class="md-nav__link">
    Lasso Regression
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-step" class="md-nav__link">
    Next Step
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../model-evaluation/" class="md-nav__link">
        Model Evaluation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../productionize-model/" class="md-nav__link">
        Productionize Model
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Essentials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Essentials" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Essentials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../essentials/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../essentials/projects/" class="md-nav__link">
        Projects
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../essentials/experiments/" class="md-nav__link">
        Experiments
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../essentials/runs/" class="md-nav__link">
        Runs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../essentials/artifacts/" class="md-nav__link">
        Artifacts
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../essentials/models/" class="md-nav__link">
        Models
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../essentials/project-settings/" class="md-nav__link">
        Project Settings
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../essentials/users/" class="md-nav__link">
        Users
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        API Reference
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/python-sdk/" class="md-nav__link">
        Python SDK
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/rest-api/" class="md-nav__link">
        REST API
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#train-test-split" class="md-nav__link">
    Train Test Split
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linear-regression" class="md-nav__link">
    Linear Regression
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lasso-regression" class="md-nav__link">
    Lasso Regression
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-step" class="md-nav__link">
    Next Step
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/MLAide/docs/edit/master/docs/tutorial/model-training.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="model-training">Model Training</h1>
<p>In the last chapter we loaded the USA Housing dataset. Now we will train two different
models on this dataset. All details of the training will be tracked in ML Aide.</p>
<p>Our code will be written in a new file named <code>training.py</code>. In the beginning
we will create a connection to the ML Aide webserver.
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">mlaide</span> <span class="kn">import</span> <span class="n">MLAideClient</span><span class="p">,</span> <span class="n">ConnectionOptions</span><span class="p">,</span> <span class="n">ArtifactRef</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">Lasso</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">options</span> <span class="o">=</span> <span class="n">ConnectionOptions</span><span class="p">(</span>
    <span class="n">server_url</span><span class="o">=</span><span class="s1">&#39;http://localhost:8881/api/v1&#39;</span><span class="p">,</span> <span class="c1"># the ML Aide demo server runs on port 8881 per default</span>
    <span class="n">api_key</span><span class="o">=</span><span class="s1">&#39;&lt;your api key&gt;&#39;</span>
<span class="p">)</span>
<span class="n">mlaide_client</span> <span class="o">=</span> <span class="n">MLAideClient</span><span class="p">(</span><span class="n">project_key</span><span class="o">=</span><span class="s1">&#39;usa-housing&#39;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
</code></pre></div></p>
<h2 id="train-test-split">Train Test Split</h2>
<p>As you can see we are implementing these steps in a different file as the data preprocessing.
Therefore we somehow need to get our input data. We could read the CSV again. Or we could
retrieve the CSV file from ML Aide. In this case we will read the content of the file from 
ML Aide. In the previous step we saved the file as an artifact with the name <code>USA housing dataset</code>.
Ommiting the version means that we want to retrieve the latest version of the artifact.
<div class="highlight"><pre><span></span><code><span class="n">dataset_bytes</span> <span class="o">=</span> <span class="n">mlaide_client</span><span class="o">.</span><span class="n">get_artifact</span><span class="p">(</span><span class="s1">&#39;USA housing dataset&#39;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;data/housing.csv&#39;</span><span class="p">)</span>
<span class="n">housing_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">dataset_bytes</span><span class="p">)</span>
</code></pre></div></p>
<p>Usually a split will be done randomly. ML Aide helps you to keep things reproducible.</p>
<p>We start a new run to track the split. Also, we set the dataset as an input artifact.</p>
<div class="highlight"><pre><span></span><code><span class="n">artifact_ref</span> <span class="o">=</span> <span class="n">ArtifactRef</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;USA housing dataset&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">run_pipeline_setup</span> <span class="o">=</span> <span class="n">mlaide_client</span><span class="o">.</span><span class="n">start_new_run</span><span class="p">(</span><span class="n">experiment_key</span><span class="o">=</span><span class="s1">&#39;linear-regression&#39;</span><span class="p">,</span> 
                                                 <span class="n">run_name</span><span class="o">=</span><span class="s1">&#39;pipeline setup&#39;</span><span class="p">,</span> 
                                                 <span class="n">used_artifacts</span><span class="o">=</span><span class="p">[</span><span class="n">artifact_ref</span><span class="p">])</span>
</code></pre></div>
<p>Now we split our dataset and link all information related to the split to our run.
In this case we want to track all arguments (<code>test_size</code> and <code>random_state</code>) of the 
<code>train_test_split()</code> function.</p>
<div class="highlight"><pre><span></span><code><span class="n">X</span> <span class="o">=</span> <span class="n">housing_data</span><span class="p">[[</span><span class="s1">&#39;Avg. Area Income&#39;</span><span class="p">,</span> <span class="s1">&#39;Avg. Area House Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Avg. Area Number of Rooms&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Avg. Area Number of Bedrooms&#39;</span><span class="p">,</span> <span class="s1">&#39;Area Population&#39;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">housing_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span>

<span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span>
<span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>

<span class="n">run_pipeline_setup</span><span class="o">.</span><span class="n">log_parameter</span><span class="p">(</span><span class="s1">&#39;test_size&#39;</span><span class="p">,</span> <span class="n">test_size</span><span class="p">)</span>
<span class="n">run_pipeline_setup</span><span class="o">.</span><span class="n">log_parameter</span><span class="p">(</span><span class="s1">&#39;random_state&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="p">)</span>
</code></pre></div>
<p>If you have a close look at the data, you can see that all X values must be scaled, before we can use them.
We use the <code>StandardScaler</code> of sklearn. The scaler that will be fitted here, must also be used later for 
predicting new values. ML Aide makes this easy by just storing the scaler (or the whole pipeline) in
ML Aide as an artifact. The artifact can be loaded later in a separate process for predicting.</p>
<div class="highlight"><pre><span></span><code><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;std_scalar&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">())</span>
<span class="p">])</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">run_pipeline_setup</span><span class="o">.</span><span class="n">log_model</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;pipeline&quot;</span><span class="p">)</span>

<span class="n">run_pipeline_setup</span><span class="o">.</span><span class="n">set_completed_status</span><span class="p">()</span>
</code></pre></div>
<h2 id="linear-regression">Linear Regression</h2>
<p>After the train-test-split, we can fit a linear regression model. We start a new run and 
link dataset and the pipeline as input artifacts.</p>
<div class="highlight"><pre><span></span><code><span class="n">dataset_artifact_ref</span> <span class="o">=</span> <span class="n">ArtifactRef</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;USA housing dataset&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pipeline_artifact_ref</span> <span class="o">=</span> <span class="n">ArtifactRef</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;pipeline&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">run_linear_regression</span> <span class="o">=</span> <span class="n">mlaide_client</span><span class="o">.</span><span class="n">start_new_run</span><span class="p">(</span><span class="n">experiment_key</span><span class="o">=</span><span class="s1">&#39;linear-regression&#39;</span><span class="p">,</span>
                                                    <span class="n">run_name</span><span class="o">=</span><span class="s1">&#39;linear regression&#39;</span><span class="p">,</span>
                                                    <span class="n">used_artifacts</span><span class="o">=</span><span class="p">[</span><span class="n">dataset_artifact_ref</span><span class="p">,</span> <span class="n">pipeline_artifact_ref</span><span class="p">])</span>
</code></pre></div>
<p>Now just fit your model as usual. After that, you can log the model with <code>log_model()</code> in ML Aide.</p>
<div class="highlight"><pre><span></span><code><span class="n">lin_reg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">lin_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

<span class="n">run_linear_regression</span><span class="o">.</span><span class="n">log_model</span><span class="p">(</span><span class="n">lin_reg</span><span class="p">,</span> <span class="s1">&#39;linear regression&#39;</span><span class="p">)</span>
</code></pre></div>
<p>Finally, we calculate some model metrics. The metrics will also be tracked in ML Aide.</p>
<div class="highlight"><pre><span></span><code><span class="n">test_pred</span> <span class="o">=</span> <span class="n">lin_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">train_pred</span> <span class="o">=</span> <span class="n">lin_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="n">mae</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">)</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">))</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">)</span>
<span class="n">cross_validation</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">run_linear_regression</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s1">&#39;mae&#39;</span><span class="p">,</span> <span class="n">mae</span><span class="p">)</span>
<span class="n">run_linear_regression</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s1">&#39;mse&#39;</span><span class="p">,</span> <span class="n">mse</span><span class="p">)</span>
<span class="n">run_linear_regression</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s1">&#39;rmse&#39;</span><span class="p">,</span> <span class="n">rmse</span><span class="p">)</span>
<span class="n">run_linear_regression</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
<span class="n">run_linear_regression</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s1">&#39;cross validation&#39;</span><span class="p">,</span> <span class="n">cross_validation</span><span class="p">)</span>

<span class="n">run_linear_regression</span><span class="o">.</span><span class="n">set_completed_status</span><span class="p">()</span>
</code></pre></div>
<h2 id="lasso-regression">Lasso Regression</h2>
<p>Until now, we created three runs (<code>data preparation</code>, <code>pipeline setup</code>, and <code>linear regression</code>). All of t
hese runs belong to the experiment <code>linear-regression</code>.</p>
<p>Now we train another model type - a lasso regression model. But we want to reuse the results of the data 
preparation and the pipeline setup. With ML Aide this can be achieved simply by using a new <code>experiment_key</code> 
and provide the artifacts of the previous runs via <code>used_artifacts</code>.</p>
<div class="highlight"><pre><span></span><code><span class="n">dataset_artifact_ref</span> <span class="o">=</span> <span class="n">ArtifactRef</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;USA housing dataset&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pipeline_artifact_ref</span> <span class="o">=</span> <span class="n">ArtifactRef</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;pipeline&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">run_lasso</span> <span class="o">=</span> <span class="n">mlaide_client</span><span class="o">.</span><span class="n">start_new_run</span><span class="p">(</span><span class="n">experiment_key</span><span class="o">=</span><span class="s1">&#39;lasso-regression&#39;</span><span class="p">,</span>
                                        <span class="n">run_name</span><span class="o">=</span><span class="s1">&#39;lasso regression&#39;</span><span class="p">,</span>
                                        <span class="n">used_artifacts</span><span class="o">=</span><span class="p">[</span><span class="n">dataset_artifact_ref</span><span class="p">,</span> <span class="n">pipeline_artifact_ref</span><span class="p">])</span>
</code></pre></div>
<p>We fit our model as usual.</p>
<div class="highlight"><pre><span></span><code><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">precompute</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">positive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">selection</span> <span class="o">=</span> <span class="s1">&#39;random&#39;</span>
<span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span>

<span class="n">run_lasso</span><span class="o">.</span><span class="n">log_parameter</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="n">run_lasso</span><span class="o">.</span><span class="n">log_parameter</span><span class="p">(</span><span class="s1">&#39;precompute&#39;</span><span class="p">,</span> <span class="n">precompute</span><span class="p">)</span>
<span class="n">run_lasso</span><span class="o">.</span><span class="n">log_parameter</span><span class="p">(</span><span class="s1">&#39;positive&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="p">)</span>
<span class="n">run_lasso</span><span class="o">.</span><span class="n">log_parameter</span><span class="p">(</span><span class="s1">&#39;selection&#39;</span><span class="p">,</span> <span class="n">selection</span><span class="p">)</span>
<span class="n">run_lasso</span><span class="o">.</span><span class="n">log_parameter</span><span class="p">(</span><span class="s1">&#39;random state&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> 
              <span class="n">precompute</span><span class="o">=</span><span class="n">precompute</span><span class="p">,</span> 
              <span class="n">positive</span><span class="o">=</span><span class="n">positive</span><span class="p">,</span> 
              <span class="n">selection</span><span class="o">=</span><span class="n">selection</span><span class="p">,</span>
              <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">run_lasso</span><span class="o">.</span><span class="n">log_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;lasso&#39;</span><span class="p">)</span>
</code></pre></div>
<p>And now we calculate some metrics for this model, too.</p>
<div class="highlight"><pre><span></span><code><span class="n">test_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">train_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="n">mae</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">)</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">))</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">)</span>
<span class="n">cross_validation</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">Lasso</span><span class="p">(),</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">run_lasso</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s1">&#39;mae&#39;</span><span class="p">,</span> <span class="n">mae</span><span class="p">)</span>
<span class="n">run_lasso</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s1">&#39;mse&#39;</span><span class="p">,</span> <span class="n">mse</span><span class="p">)</span>
<span class="n">run_lasso</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s1">&#39;rmse&#39;</span><span class="p">,</span> <span class="n">rmse</span><span class="p">)</span>
<span class="n">run_lasso</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
<span class="n">run_lasso</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s1">&#39;cross validation&#39;</span><span class="p">,</span> <span class="n">cross_validation</span><span class="p">)</span>

<span class="n">run_lasso</span><span class="o">.</span><span class="n">set_completed_status</span><span class="p">()</span>
</code></pre></div>
<p>Start your python script using your shell with <code>python training.py</code>. After the script completed check the 
<a href="http://localhost:8880/projects/usa-housing">Web UI</a> to see the created runs and the artifact.</p>
<h2 id="conclusion">Conclusion</h2>
<h2 id="next-step">Next Step</h2>
<p>In the next chapter we will learn how to evaluate models with ML Aide.</p>
<h2 id="summary">Summary</h2>
<p>In this chapter we</p>
<ul>
<li>created a sklearn pipeline with a standard scaler</li>
<li>trained a linear regression model</li>
<li>trained a lasso regression model</li>
</ul>
<p>All these steps were tracked in ML Aide as separate runs. The runs included all parameters and 
metrics that we need for reproducibility and further investigation. The pipeline and the models 
are stored as artifacts in ML Aide.</p>
<p>Your code should look like the following snippet shows.</p>
<details class="note"><summary>Code</summary><div class="tabbed-set" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">training.py</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">mlaide</span> <span class="kn">import</span> <span class="n">MLAideClient</span><span class="p">,</span> <span class="n">ConnectionOptions</span><span class="p">,</span> <span class="n">ArtifactRef</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">Lasso</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>

<span class="c1"># create connection</span>
<span class="n">options</span> <span class="o">=</span> <span class="n">ConnectionOptions</span><span class="p">(</span>
    <span class="n">server_url</span><span class="o">=</span><span class="s1">&#39;http://localhost:8881/api/v1&#39;</span><span class="p">,</span> <span class="c1"># the ML Aide demo server runs on port 8881 per default</span>
    <span class="n">api_key</span><span class="o">=</span><span class="s1">&#39;&lt;your api key&gt;&#39;</span>
<span class="p">)</span>
<span class="n">mlaide_client</span> <span class="o">=</span> <span class="n">MLAideClient</span><span class="p">(</span><span class="n">project_key</span><span class="o">=</span><span class="s1">&#39;usa-housing&#39;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>

<span class="c1"># get housing dataset</span>
<span class="n">dataset_bytes</span> <span class="o">=</span> <span class="n">mlaide_client</span><span class="o">.</span><span class="n">get_artifact</span><span class="p">(</span><span class="s1">&#39;USA housing dataset&#39;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;data/housing.csv&#39;</span><span class="p">)</span>
<span class="n">housing_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">dataset_bytes</span><span class="p">)</span>

<span class="n">artifact_ref</span> <span class="o">=</span> <span class="n">ArtifactRef</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;USA housing dataset&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">run_pipeline_setup</span> <span class="o">=</span> <span class="n">mlaide_client</span><span class="o">.</span><span class="n">start_new_run</span><span class="p">(</span><span class="n">experiment_key</span><span class="o">=</span><span class="s1">&#39;linear-regression&#39;</span><span class="p">,</span> 
                                                 <span class="n">run_name</span><span class="o">=</span><span class="s1">&#39;pipeline setup&#39;</span><span class="p">,</span> 
                                                 <span class="n">used_artifacts</span><span class="o">=</span><span class="p">[</span><span class="n">artifact_ref</span><span class="p">])</span>

<span class="c1"># train test split</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">housing_data</span><span class="p">[[</span><span class="s1">&#39;Avg. Area Income&#39;</span><span class="p">,</span> <span class="s1">&#39;Avg. Area House Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Avg. Area Number of Rooms&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Avg. Area Number of Bedrooms&#39;</span><span class="p">,</span> <span class="s1">&#39;Area Population&#39;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">housing_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span>

<span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span>
<span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>

<span class="n">run_pipeline_setup</span><span class="o">.</span><span class="n">log_parameter</span><span class="p">(</span><span class="s1">&#39;test_size&#39;</span><span class="p">,</span> <span class="n">test_size</span><span class="p">)</span>
<span class="n">run_pipeline_setup</span><span class="o">.</span><span class="n">log_parameter</span><span class="p">(</span><span class="s1">&#39;random_state&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="p">)</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;std_scalar&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">())</span>
<span class="p">])</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">run_pipeline_setup</span><span class="o">.</span><span class="n">log_model</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;pipeline&quot;</span><span class="p">)</span>

<span class="n">run_pipeline_setup</span><span class="o">.</span><span class="n">set_completed_status</span><span class="p">()</span>

<span class="c1"># linear regression</span>
<span class="n">dataset_artifact_ref</span> <span class="o">=</span> <span class="n">ArtifactRef</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;USA housing dataset&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pipeline_artifact_ref</span> <span class="o">=</span> <span class="n">ArtifactRef</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;pipeline&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">run_linear_regression</span> <span class="o">=</span> <span class="n">mlaide_client</span><span class="o">.</span><span class="n">start_new_run</span><span class="p">(</span><span class="n">experiment_key</span><span class="o">=</span><span class="s1">&#39;linear-regression&#39;</span><span class="p">,</span>
                                                    <span class="n">run_name</span><span class="o">=</span><span class="s1">&#39;linear regression&#39;</span><span class="p">,</span>
                                                    <span class="n">used_artifacts</span><span class="o">=</span><span class="p">[</span><span class="n">dataset_artifact_ref</span><span class="p">,</span> <span class="n">pipeline_artifact_ref</span><span class="p">])</span>

<span class="n">lin_reg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">lin_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

<span class="n">run_linear_regression</span><span class="o">.</span><span class="n">log_model</span><span class="p">(</span><span class="n">lin_reg</span><span class="p">,</span> <span class="s1">&#39;linear regression&#39;</span><span class="p">)</span>

<span class="n">test_pred</span> <span class="o">=</span> <span class="n">lin_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">train_pred</span> <span class="o">=</span> <span class="n">lin_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="n">mae</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">)</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">))</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">)</span>
<span class="n">cross_validation</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">run_linear_regression</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s1">&#39;mae&#39;</span><span class="p">,</span> <span class="n">mae</span><span class="p">)</span>
<span class="n">run_linear_regression</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s1">&#39;mse&#39;</span><span class="p">,</span> <span class="n">mse</span><span class="p">)</span>
<span class="n">run_linear_regression</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s1">&#39;rmse&#39;</span><span class="p">,</span> <span class="n">rmse</span><span class="p">)</span>
<span class="n">run_linear_regression</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
<span class="n">run_linear_regression</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s1">&#39;cross validation&#39;</span><span class="p">,</span> <span class="n">cross_validation</span><span class="p">)</span>

<span class="n">run_linear_regression</span><span class="o">.</span><span class="n">set_completed_status</span><span class="p">()</span>

<span class="c1"># lasso regression</span>
<span class="n">dataset_artifact_ref</span> <span class="o">=</span> <span class="n">ArtifactRef</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;USA housing dataset&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pipeline_artifact_ref</span> <span class="o">=</span> <span class="n">ArtifactRef</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;pipeline&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">run_lasso</span> <span class="o">=</span> <span class="n">mlaide_client</span><span class="o">.</span><span class="n">start_new_run</span><span class="p">(</span><span class="n">experiment_key</span><span class="o">=</span><span class="s1">&#39;lasso-regression&#39;</span><span class="p">,</span>
                                        <span class="n">run_name</span><span class="o">=</span><span class="s1">&#39;lasso regression&#39;</span><span class="p">,</span>
                                        <span class="n">used_artifacts</span><span class="o">=</span><span class="p">[</span><span class="n">dataset_artifact_ref</span><span class="p">,</span> <span class="n">pipeline_artifact_ref</span><span class="p">])</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">precompute</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">positive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">selection</span> <span class="o">=</span> <span class="s1">&#39;random&#39;</span>
<span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span>

<span class="n">run_lasso</span><span class="o">.</span><span class="n">log_parameter</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<span class="n">run_lasso</span><span class="o">.</span><span class="n">log_parameter</span><span class="p">(</span><span class="s1">&#39;precompute&#39;</span><span class="p">,</span> <span class="n">precompute</span><span class="p">)</span>
<span class="n">run_lasso</span><span class="o">.</span><span class="n">log_parameter</span><span class="p">(</span><span class="s1">&#39;positive&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="p">)</span>
<span class="n">run_lasso</span><span class="o">.</span><span class="n">log_parameter</span><span class="p">(</span><span class="s1">&#39;selection&#39;</span><span class="p">,</span> <span class="n">selection</span><span class="p">)</span>
<span class="n">run_lasso</span><span class="o">.</span><span class="n">log_parameter</span><span class="p">(</span><span class="s1">&#39;random state&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> 
              <span class="n">precompute</span><span class="o">=</span><span class="n">precompute</span><span class="p">,</span> 
              <span class="n">positive</span><span class="o">=</span><span class="n">positive</span><span class="p">,</span> 
              <span class="n">selection</span><span class="o">=</span><span class="n">selection</span><span class="p">,</span>
              <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">run_lasso</span><span class="o">.</span><span class="n">log_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;lasso&#39;</span><span class="p">)</span>

<span class="n">test_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">train_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="n">mae</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">)</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">))</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">test_pred</span><span class="p">)</span>
<span class="n">cross_validation</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">Lasso</span><span class="p">(),</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">run_lasso</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s1">&#39;mae&#39;</span><span class="p">,</span> <span class="n">mae</span><span class="p">)</span>
<span class="n">run_lasso</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s1">&#39;mse&#39;</span><span class="p">,</span> <span class="n">mse</span><span class="p">)</span>
<span class="n">run_lasso</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s1">&#39;rmse&#39;</span><span class="p">,</span> <span class="n">rmse</span><span class="p">)</span>
<span class="n">run_lasso</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
<span class="n">run_lasso</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s1">&#39;cross validation&#39;</span><span class="p">,</span> <span class="n">cross_validation</span><span class="p">)</span>

<span class="n">run_lasso</span><span class="o">.</span><span class="n">set_completed_status</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">data_preparation.py</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">mlaide</span> <span class="kn">import</span> <span class="n">MLAideClient</span><span class="p">,</span> <span class="n">ConnectionOptions</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">options</span> <span class="o">=</span> <span class="n">ConnectionOptions</span><span class="p">(</span>
    <span class="n">server_url</span><span class="o">=</span><span class="s1">&#39;http://localhost:8881/api/v1&#39;</span><span class="p">,</span> <span class="c1"># the ML Aide demo server runs on port 8881 per default</span>
    <span class="n">api_key</span><span class="o">=</span><span class="s1">&#39;&lt;your api key&gt;&#39;</span>
<span class="p">)</span>
<span class="n">mlaide_client</span> <span class="o">=</span> <span class="n">MLAideClient</span><span class="p">(</span><span class="n">project_key</span><span class="o">=</span><span class="s1">&#39;usa-housing&#39;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>

<span class="n">run_data_preparation</span> <span class="o">=</span> <span class="n">mlaide_client</span><span class="o">.</span><span class="n">start_new_run</span><span class="p">(</span><span class="n">experiment_key</span><span class="o">=</span><span class="s1">&#39;linear-regression&#39;</span><span class="p">,</span> <span class="n">run_name</span><span class="o">=</span><span class="s1">&#39;data preparation&#39;</span><span class="p">)</span>

<span class="n">housing_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/housing.csv&#39;</span><span class="p">)</span>

<span class="c1"># add dataset as artifact</span>
<span class="n">artifact</span> <span class="o">=</span> <span class="n">run_data_preparation</span><span class="o">.</span><span class="n">create_artifact</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;USA housing dataset&quot;</span><span class="p">,</span> <span class="n">artifact_type</span><span class="o">=</span><span class="s2">&quot;dataset&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{})</span>
<span class="n">run_data_preparation</span><span class="o">.</span><span class="n">add_artifact_file</span><span class="p">(</span><span class="n">artifact</span><span class="p">,</span> <span class="s1">&#39;data/housing.csv&#39;</span><span class="p">)</span>

<span class="n">run_data_preparation</span><span class="o">.</span><span class="n">set_completed_status</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><label for="__tabbed_1_3">data/housing.csv</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>a lot of housing data
</code></pre></div>
</div>
</div>
</details>
<p>In the next chapter, we will learn how to evaluate models with ML Aide.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../data-preparation/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Data Preparation
            </div>
          </div>
        </a>
      
      
        <a href="../model-evaluation/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Model Evaluation
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "search.highlight", "search.share"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.4ea5477f.min.js"></script>
      
    
  </body>
</html>